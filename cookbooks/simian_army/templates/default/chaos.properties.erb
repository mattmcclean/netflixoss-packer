#
## Chaos Monkey Configuration File
#
## Dynamically generated by Chef on <%= node['fqdn'] %>
##
## Local modifications will be overwritten by Chef.
##

simianarmy.chaos.enabled=<%= node['simian_army']['chaos']['enabled'] ? 'true' : 'false' %>
simianarmy.chaos.leashed=<%= node['simian_army']['chaos']['leashed'] ? 'true' : 'false' %>
simianarmy.chaos.ASG.enabled=<%= node['simian_army']['chaos']['ASG']['enabled'] ? 'true' : 'false' %>
simianarmy.chaos.ASG.probability=<%= node['simian_army']['chaos']['ASG']['probability'] %>
simianarmy.chaos.ASG.maxTerminationsPerDay=<%= node['simian_army']['chaos']['ASG']['maxTerminationsPerDay'] %>
simianarmy.chaos.terminateOndemand.enabled=<%= node['simian_army']['chaos']['terminateOndemand']['enabled'] ? 'true' : 'false' %>
simianarmy.chaos.mandatoryTermination.enabled=<%= node['simian_army']['chaos']['mandatoryTermination']['enabled'] ? 'true' : 'false' %>
simianarmy.chaos.mandatoryTermination.windowInDays=<%= node['simian_army']['chaos']['mandatoryTermination']['windowInDays'] %>
simianarmy.chaos.mandatoryTermination.defaultProbability=<%= node['simian_army']['chaos']['mandatoryTermination']['defaultProbability'] %>

<% if !node['simian_army']['chaos']['ASG']['groups'].nil? %>
<% node['simian_army']['chaos']['ASG']['groups'].each do |asg| %>
simianarmy.chaos.ASG.<%= asg['name'] %>.enabled=<%= asg['enabled'] ? 'true' : 'false' %>
simianarmy.chaos.ASG.<%= asg['name'] %>.probability=<%= asg['probability'] %>
simianarmy.chaos.ASG.<%= asg['name'] %>.maxTerminationsPerDay=<%= (!asg['maxTerminationsPerDay'].nil? ? asg['maxTerminationsPerDay'] : "1.0") %>
simianarmy.chaos.ASG.<%= asg['name'] %>.lastOptInTimeInMilliseconds=<%= (!asg['lastOptInTimeInMilliseconds'].nil? ? asg['lastOptInTimeInMilliseconds'] : "1234567") %>
simianarmy.chaos.ASG.<%= asg['name'] %>.ownerEmail=<%= (!asg['ownerEmail'].nil? ? asg['ownerEmail'] : "the.owner@email.com") %>
simianarmy.chaos.ASG.<%= asg['name'] %>.notification.enabled=<%= asg['notification_enabled'] ? 'true' : 'false' %>
<% end %>
<% end %>

<% if node['simian_army']['chaos']['notification']['enabled'] %>
simianarmy.chaos.notification.sourceEmail=<%= node['simian_army']['chaos']['notification']['sourceEmail'] %>
simianarmy.chaos.notification.global.enabled=<%= node['simian_army']['chaos']['notification']['global']['enabled'] ? 'true' : 'false' %>
simianarmy.chaos.notification.global.receiverEmail=<%= node['simian_army']['chaos']['notification']['global']['receiverEmail'] %>
simianarmy.chaos.notification.subject.prefix=<%= node['simian_army']['chaos']['notification']['subject']['prefix'] %>
simianarmy.chaos.notification.subject.suffix=<%= node['simian_army']['chaos']['notification']['subject']['suffix'] %>
simianarmy.chaos.notification.body.prefix=<%= node['simian_army']['chaos']['notification']['body']['prefix'] %>
simianarmy.chaos.notification.body.suffix=<%= node['simian_army']['chaos']['notification']['body']['suffix'] %>
simianarmy.chaos.notification.subject.isBody=<%= node['simian_army']['chaos']['notification']['subject']['isBody'] ? 'true' : 'false' %>
<% end %>
